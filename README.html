<!DOCTYPE html>
<html>
<head>
<title>README.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<p>Esse repositório possui o resultado final do <a href="https://docs.djangoproject.com/en/3.1/intro/tutorial01/">tutorial do Django</a> + um resumo desse tutorial com explicação dos aspectos mais importantes.</p>
<h1 id="parte-1">Parte 1</h1>
<p>O objetivo dessa parte é criar um projeto e uma aplicação.</p>
<h2 id="criando-um-projeto">Criando um projeto</h2>
<ol>
<li>Um projeto é um pacote python que contém todas as configurações necessárias para uma instância Django. Isso inclui uma configuração do banco de dados, opções específicas do Django e configurações específicas de aplicações.</li>
</ol>
<p>Vá para o diretório onde quer criar o projeto e digite:</p>
<pre class="hljs"><code><div>$ django-admin startproject mysite
</div></code></pre>
<p>Isso vai criar uma pasta mysite com a seguinte estrutura:</p>
<pre class="hljs"><code><div>mysite/
    manage.py
    mysite/
        __init__.py
        settings.py
        urls.py
        asgi.py
        wsgi.py
</div></code></pre>
<p>Resumindo a função de cada um desses arquivos/pastas:</p>
<ul>
<li>mysite/ (externo): Contâiner do projeto.</li>
<li>manage.py: Acessar esse arquivo via linha de comando te permite interagir com o projeto de várias formas.</li>
<li>mysite/ (interno): Pacote python do projeto.</li>
<li>mysite/<strong>init</strong>.py: Arquivo vazio que diz ao python que esse diretório deve ser considerado um pacote python.</li>
<li>mysite/settings.py: Nesse arquivo você configura o seu projeto Django.</li>
<li>mysite/urls.py: Nesse arquivo você define as URLs do seu projeto.</li>
<li>mysite/asgi.py: Um ponto de entrada para servidores web ASGI-compatíveis.</li>
<li>mysite/wsgi.py: Um ponto de entrada para servidores web WSGI-compatíveis.</li>
</ul>
<ol start="2">
<li>Para rodar o servidor, vá ao diretório mysite externo e rode o seguinte comando:</li>
</ol>
<pre class="hljs"><code><div>$ python manage.py runserver
</div></code></pre>
<p>Um servidor de desenvolvimento será gerado no localhost (http://127.0.0.1:8000/).</p>
<h2 id="criando-a-aplica%C3%A7%C3%A3o-polls">Criando a aplicação Polls</h2>
<ol>
<li>Cada aplicação consiste em um pacote python que segue uma determinada convenção. A aplicação é criada dentro do projeto.</li>
</ol>
<p>Observação: Uma aplicação (app) é uma aplicação web que realiza alguma função. Um projeto é uma coleção de apps para um determinado site. Um projeto pode conter múltiplos apps. Um app pode ser utilizado em múltiplos projetos.</p>
<ol start="2">
<li>Para criar o app, vá para o mesmo diretório de manage.py e execute o seguinte comando:</li>
</ol>
<pre class="hljs"><code><div>$ python manage.py startapp polls
</div></code></pre>
<p>A estrutura criada vai conter a aplicação:</p>
<pre class="hljs"><code><div>polls/
    __init__.py
    admin.py
    apps.py
    migrations/
        __init__.py
    models.py
    tests.py
    views.py
</div></code></pre>
<ol start="3">
<li>Vá para o polls/views.py e mude o código:</li>
</ol>
<pre class="hljs"><code><div>from django.http import HttpResponse

def index(request):
    return HttpResponse(&quot;Hello, world. You're at the polls index.&quot;)
</div></code></pre>
<p>Para chamar a view, é necessário atribuir uma URL. Para isso, crie um arquivo chamado urls.py dentro do diretório polls. Dentro desse arquivo escreva o seguinte código:</p>
<pre class="hljs"><code><div>from django.urls import path

from . import views

urlpatterns = [
    path('', views.index, name='index'),
]
</div></code></pre>
<ol start="3">
<li>Agora é necessário apontar esse módulo polls.urls no arquivo de configuração de URL geral, o URLconf. Isso é feito no arquivo mysite/urls.py da seguinte forma:</li>
</ol>
<pre class="hljs"><code><div>from django.contrib import admin
from django.urls import include, path

urlpatterns = [
    path('polls/', include('polls.urls')),
    path('admin/', admin.site.urls),
]
</div></code></pre>
<p>Veja que no array urlpatterns nós adicionamos o item correspondente ao arquivo polls/urls.py.</p>
<p>A função include() permite referenciar outras URLconfs.</p>
<p>A função path() recebe 4 argumentos. Dois deles são necessários: route e view. Os outros são kwargs e name.</p>
<ul>
<li>route: É a string com a URL. Quando processando um request, o Django começa no primeiro padrão de url patterns e vai descendo a lista, comparando a URLS requisitada com cada padrão até encontrar algum que dê match.</li>
<li>view: Quando o Django encontra um padrão, ele chama a função view específica com um objeto de HttpRequest como primeiro argumento e qualquer valor capturado pela rota como argumentos.</li>
<li>kwargs: &quot;keyword arguments&quot;.</li>
<li>name: É possível dar nome à URL e chamá-la em qualquer lugar no Django, especialmente dentro de templates.</li>
</ul>
<h1 id="parte-2">Parte 2</h1>
<p>O objetivo dessa parte é criar o banco de dados, criar o primeiro modelo e fazer uma introdução ao site de administração gerado automaticamente.</p>
<h2 id="setup-do-banco-de-dados">Setup do banco de dados</h2>
<ol>
<li>Abra o mysite/settings.py. Esse módulo possui variáveis que representam as configurações do Django. Setar a TIME_ZONE para a local.</li>
</ol>
<p>Observação: O Django usa, por padrão, o SQLite. Ele é incluído no python, logo não é preciso instalar nada.</p>
<ol start="2">
<li>O array INSTALLED_APPS possui o nome de todas as aplicações (apps) ativadas do Django. Os apps podem ser usados em múltiplos projetos. Alguns apps já vem com o Django:</li>
</ol>
<pre class="hljs"><code><div>django.contrib.admin
django.contrib.auth
django.contrib.contenttypes
django.contrib.sessions
django.contrib.messages
django.contrib.staticfiles
</div></code></pre>
<p>Essas aplicações usam tabelas do banco de dados, portanto as tabelas precisam ser criadas antes que as aplicações possam ser usadas. Para isso, rodar:</p>
<pre class="hljs"><code><div>$ python manage.py migrate
</div></code></pre>
<p>Uma mensagem vai aparecer mostrando as operações feitas. O comando 'migrate' olha para o array INSTALLED_APPS e cria as tabelas necessárias de acordo com as configurações do banco de dados presentes no mysite/settings.py e para os database migrations feitos no app.</p>
<h2 id="criando-models">Criando models</h2>
<p>Model é o layout do banco de dados. Ele contém apenas os campos essenciais dos dados que você vai armazenar. Os comandos de migrate olham atuam sobre os arquivos model.</p>
<ol>
<li>Criar dois models: Question e Choice. Question tem uma pergunta e uma data de publicação. Choice tem o texto da escolha e a contagem de votos.</li>
</ol>
<p>Para criar os models, editar o arquivo polls/models.py da seguinte forma:</p>
<pre class="hljs"><code><div>from django.db import models


class Question(models.Model):
    question_text = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published')


class Choice(models.Model):
    question = models.ForeignKey(Question, on_delete=models.CASCADE)
    choice_text = models.CharField(max_length=200)
    votes = models.IntegerField(default=0)
</div></code></pre>
<p>Cada modelo é representado por uma classe que chama django.db.models.Model. O modelo tem um número de variáveis, cada uma representando um campo do banco de dados.</p>
<p>Cada campo é representado por uma instância da classe Field, como CharField e DateTimeField. O nome de cada uma dessas instâncias (question_text, pub_date) será o nome do campo.</p>
<p>A classe ForeignKey é usada para determinar uma relação entre Choice e Question: cada Choice é relacionada a apenas uma Question.</p>
<h2 id="ativando-models">Ativando models</h2>
<ol>
<li>O código em polls/models.py é utilizado pelo Django para:</li>
</ol>
<ul>
<li>criar um database schema para o app (statement CREATE TABLE).</li>
<li>criar uma api de acesso ao banco de dados para acessar os objetos Question e Choice.</li>
</ul>
<ol start="2">
<li>Antes de usar esse app, precisamos indicar que ele foi instalado. Para incluí-lo no projeto, é necessário fazer uma referência da sua classe de configuração no array INSTALLED_APPS em mysite/settings.py. A classe de configuração fica em polls/apps.py e se chama PollsConfig. Portanto, seu caminho é polls.apps.PollsConfig. Adicione isso no mysite/settings.py:</li>
</ol>
<pre class="hljs"><code><div>INSTALLED_APPS = [
    'polls.apps.PollsConfig',
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
]
</div></code></pre>
<ol start="3">
<li>Temos que incluir o app polls. Execute o seguinte comando:</li>
</ol>
<pre class="hljs"><code><div>$ python manage.py makemigrations polls
</div></code></pre>
<p>Uma mensagem de criação dos modelos deve aparecer.</p>
<p>O comando makemigrations diz que mudanças foram feitas e que elas devem ser armazenadas como uma migration.</p>
<p>A migration é a forma como o Django armazena as mudanças nos modelos - ou seja, mudanças no database schema. Quando você executa makemigrations, uma migration é criada na forma de um arquivo. O arquivo criado pode ser encontrado em polls/migrations/0001_initial.py.</p>
<ol start="4">
<li>Para ver qual o código SQL que a migration vai rodar, execute:</li>
</ol>
<pre class="hljs"><code><div>$ python manage.py sqlmigrate polls 0001
</div></code></pre>
<p>O output é:</p>
<pre class="hljs"><code><div>BEGIN;
--
-- Create model Question
--
CREATE TABLE &quot;polls_question&quot; (
    &quot;id&quot; serial NOT NULL PRIMARY KEY,
    &quot;question_text&quot; varchar(200) NOT NULL,
    &quot;pub_date&quot; timestamp with time zone NOT NULL
);
--
-- Create model Choice
--
CREATE TABLE &quot;polls_choice&quot; (
    &quot;id&quot; serial NOT NULL PRIMARY KEY,
    &quot;choice_text&quot; varchar(200) NOT NULL,
    &quot;votes&quot; integer NOT NULL,
    &quot;question_id&quot; integer NOT NULL
);
ALTER TABLE &quot;polls_choice&quot;
  ADD CONSTRAINT &quot;polls_choice_question_id_c5b4b260_fk_polls_question_id&quot;
    FOREIGN KEY (&quot;question_id&quot;)
    REFERENCES &quot;polls_question&quot; (&quot;id&quot;)
    DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX &quot;polls_choice_question_id_c5b4b260&quot; ON &quot;polls_choice&quot; (&quot;question_id&quot;);

COMMIT;
</div></code></pre>
<p>Observações:</p>
<ul>
<li>Nomes de tabelas são gerados combinando o nome do app (polls) com o nome do modelo (question e choice).</li>
<li>Primary keys são adicionadas automaticamente.</li>
<li>&quot;_id&quot; é adicionado no fim do nome da foreign key.</li>
<li>O código SQL não foi executado, só mostrado.</li>
</ul>
<ol start="4">
<li>Caso queira, o comando</li>
</ol>
<pre class="hljs"><code><div>$ python manage.py check
</div></code></pre>
<p>pode ser executado. Sua função é checar se há algum problema no projeto. Todos os apps são checados.</p>
<ol start="5">
<li>Para criar as tabelas dos models no banco de dados (rodar o código SQL) execute o seguinte comando:</li>
</ol>
<pre class="hljs"><code><div>$ python manage.py migrate
</div></code></pre>
<p>O comando migrate executa todas as migrations que ainda não foram executadas. Ou seja, as mudanças feitas nos models são aplicadas e adicionadas ao banco de dados.</p>
<p>Portanto, as 3 etapas de interação com o banco de dados são:</p>
<ul>
<li>Mudar os models no models.py</li>
<li>Criar migrations (pré-código SQL) com python manage.py makemigrations</li>
<li>Aplicar mudanças no banco de dados (executar o código SQL) com python manage.py migrate</li>
</ul>
<h2 id="brincando-com-a-api">Brincando com a API</h2>
<p>Para abrir a shell do python:</p>
<p>´´´
$ python manage.py shell
´´´</p>
<p>Na shell, escreva:</p>
<pre class="hljs"><code><div># Importa os models que fizemos.
&gt;&gt;&gt; from polls.models import Choice, Question

# Não há nenhuma questão no sistema ainda.
&gt;&gt;&gt; Question.objects.all()
&lt;QuerySet []&gt;

# Criar uma nova questão, determinar seu texto e atribuir um horário a ela.
&gt;&gt;&gt; from django.utils import timezone
&gt;&gt;&gt; q = Question(question_text=&quot;What's new?&quot;, pub_date=timezone.now())

# Salvar objeto no banco de dados.
&gt;&gt;&gt; q.save()

# Agora a questão tem um id.
&gt;&gt;&gt; q.id
1

# Acessar campos válidos do model via atributos do python.
&gt;&gt;&gt; q.question_text
&quot;What's new?&quot;
&gt;&gt;&gt; q.pub_date
datetime.datetime(2012, 2, 26, 13, 0, 0, 775217, tzinfo=&lt;UTC&gt;)

# Mudar valores e depois salvar.
&gt;&gt;&gt; q.question_text = &quot;What's up?&quot;
&gt;&gt;&gt; q.save()

# objects.all() mostra todas as questões do banco de dados.
&gt;&gt;&gt; Question.objects.all()
&lt;QuerySet [&lt;Question: Question object (1)&gt;]&gt;
</div></code></pre>
<p>Para mudar essa mensagem final, vá para polls/models.py e adicione o método <strong>str</strong>() nos models Question e Choice:</p>
<pre class="hljs"><code><div>from django.db import models

class Question(models.Model):
    # ...
    def __str__(self):
        return self.question_text

class Choice(models.Model):
    # ...
    def __str__(self):
        return self.choice_text
</div></code></pre>
<p>Adicione também o seguinte método:</p>
<pre class="hljs"><code><div>import datetime

from django.db import models
from django.utils import timezone


class Question(models.Model):
    # ...
    def was_published_recently(self):
        return self.pub_date &gt;= timezone.now() - datetime.timedelta(days=1)
</div></code></pre>
<p>Volte ao terminal:</p>
<pre class="hljs"><code><div>$ from polls manage.py shell

# Mostre que __str__() foi adicionado
&gt;&gt;&gt; Question.objects.all()
&lt;QuerySet [&lt;Question: What's up?&gt;]&gt;

# Podemos relacionar as questions via primary key. Usar pk=1 vai mostrar a question de primary key igual a 1.
&gt;&gt;&gt; Question.objects.get(pk=1)
&lt;Question: What's up?&gt;

# Mostre que o método adicionado no model Question funciona.
&gt;&gt;&gt; q = Question.objects.get(pk=1)
&gt;&gt;&gt; q.was_published_recently()
True

# Mostre as choices existentes
&gt;&gt;&gt; q.choice_set.all()
&lt;QuerySet []&gt;

# Crie três choices.
&gt;&gt;&gt; q.choice_set.create(choice_text='Not much', votes=0)
&lt;Choice: Not much&gt;
&gt;&gt;&gt; q.choice_set.create(choice_text='The sky', votes=0)
&lt;Choice: The sky&gt;
&gt;&gt;&gt; c = q.choice_set.create(choice_text='Just hacking again', votes=0)

# Mostre as choices
&gt;&gt;&gt; q.choice_set.all()
&lt;QuerySet [&lt;Choice: Not much&gt;, &lt;Choice: The sky&gt;, &lt;Choice: Just hacking again&gt;]&gt;
&gt;&gt;&gt; q.choice_set.count()
3

# Apague uma choice
&gt;&gt;&gt; c = q.choice_set.filter(choice_text__startswith='Just hacking')
&gt;&gt;&gt; c.delete()
</div></code></pre>
<h2 id="introdu%C3%A7%C3%A3o-ao-django-admin">Introdução ao Django Admin</h2>
<ol>
<li>Crie um superusuário para entrar na página de admin com o seguinte comando:</li>
</ol>
<pre class="hljs"><code><div>$ python manage.py createsuperuser
</div></code></pre>
<p>Insira o nome de usuário, email e senha para completar o processo.</p>
<ol start="2">
<li>
<p>Execute &quot;$ python manage.py runserver&quot; para abrir o servidor e acesse /admin para entrar na página de login. Ao fazer o login com o nome e senha definidos anteriormente, você verá a página de administração de usuários e grupos.</p>
</li>
<li>
<p>Para fazer com que os objetos Question tenham interface na página de admin, abra polls/admin.py e adicione o seguinte:</p>
</li>
</ol>
<pre class="hljs"><code><div>from django.contrib import admin

from .models import Question

admin.site.register(Question)

</div></code></pre>
<h1 id="parte-3">Parte 3</h1>
<p>O objetivo desta parte é continuar o app de polls com foco na criação de uma interface pública - &quot;views&quot;</p>
<h2 id="vis%C3%A3o-geral">Visão geral</h2>
<ol>
<li>Uma view é um tipo de página web na aplicação que serve a um propósito e tem um template específico.</li>
</ol>
<p>Nossa aplicação poll terá essas 4 views:</p>
<ul>
<li>Página &quot;index&quot; de Question: Mostra as últimas questions.</li>
<li>Página &quot;detail&quot; de Question: Mostra um texto de question sem resultados mas com um formulário de votação.</li>
<li>Página &quot;results&quot; de Question: Mostra os resultados para uma question.</li>
<li>Vote action: Lida com a votação de uma choice específica de uma question específica.</li>
</ul>
<ol start="2">
<li>
<p>No Django, as views lidam com web pages e outros conteúdos. Cada view é representada por uma função/método python. A view é determinada através da URL que é requisitada. O padrão URL é a forma geral do URL. Exemplo: /newsarchive/+year+/+month+/.</p>
</li>
<li>
<p>Adicione novas views no polls/views.py:</p>
</li>
</ol>
<pre class="hljs"><code><div>def detail(request, question_id):
    return HttpResponse(&quot;You're looking at question %s.&quot; % question_id)

def results(request, question_id):
    response = &quot;You're looking at the results of question %s.&quot;
    return HttpResponse(response % question_id)

def vote(request, question_id):
    return HttpResponse(&quot;You're voting on question %s.&quot; % question_id)
</div></code></pre>
<p>Essas views são diferentes porque levam um argumento &quot;question_id&quot;.</p>
<ol start="4">
<li>Vá a polls/urls.py e adicione novos urlpatterns:</li>
</ol>
<pre class="hljs"><code><div>from django.urls import path

from . import views

urlpatterns = [
    # ex: /polls/
    path('', views.index, name='index'),
    # ex: /polls/5/
    path('&lt;int:question_id&gt;/', views.detail, name='detail'),
    # ex: /polls/5/results/
    path('&lt;int:question_id&gt;/results/', views.results, name='results'),
    # ex: /polls/5/vote/
    path('&lt;int:question_id&gt;/vote/', views.vote, name='vote'),
]
</div></code></pre>
<p>Agora o site apresenta respostas para polls/algumnumero, polls/algumnumero/results e polls/algumnumero/vote.</p>
<p>Lembre-se: a view é determinada pela url (e não o contrário!). Acessar o página /polls/10 vai executar o método detail() utilizando 10 como question_id.</p>
<p>Quando alguém requisita uma página do site - por exemplo, &quot;polls/34/&quot;, o Django carrega o módulo mysite.urls porque ele é apontado pela configuração ROOT_URLCONF (presente em mysite/settings.py). Lá ele encontra a variável urlpatterns e lê os padrões um por um. Quando encontra &quot;polls/&quot;, ele corta a parte da string igual (&quot;polls/&quot;) e manda a string restante (&quot;34/&quot;) para o URLconf de polls.url para procurar lá. Lá ele encontra</p>
<pre class="hljs"><code><div>'&lt;int:question_id/&gt;'
</div></code></pre>
<p>e chama o método detail(). Usar os sinais &quot;maior de&quot; e &quot;menor de&quot; permite capturar parte da URL e usá-la como argumento da função da view. A parte &quot;:question_id&gt;&quot; da string define o nome do padrão da URL. A parte &quot;int:&quot; é um converter que determina quais padrões devem ser iguais à URL.</p>
<h2 id="escreva-views-que-fazem-alguma-coisa">Escreva views que fazem alguma coisa</h2>
<p>Cada view faz duas coisas: retorna um objeto do tipo HttpResponse com o conteúdo para a página requisitada ou apresenta uma exception (tipo Http404).</p>
<ol>
<li>Coloque o código abaixo na view. Ele mostra as últimas 5 questions do sistema separadas por vírgula e de acordo com a data de publicação:</li>
</ol>
<pre class="hljs"><code><div>from django.http import HttpResponse

from .models import Question


def index(request):
    latest_question_list = Question.objects.order_by('-pub_date')[:5]
    output = ', '.join([q.question_text for q in latest_question_list])
    return HttpResponse(output)

# não mexer nas outras views (detail, results, vote)
</div></code></pre>
<ol start="2">
<li>O design da página está hard-coded (se você quiser mudar a forma como a página se apresenta, terá que mudar o código). Para mudar isso, vamos usar o sistema de template do Django.</li>
</ol>
<p>Crie um diretório chamado templates dentro do diretório polls. É aí que o Django vai buscar por templates.</p>
<p>A configuração TEMPLATES (em mysite/settings.py) descreve a forma em que o Django carrega e renderiza os templates. A configuração default tem um DjangoTemplates cuja opção APP_DIRS é setada como True. Por convenção, DjangoTemplates procura por subdiretórios &quot;templates&quot; em cada um dos INSTALLED_APPS.</p>
<ol start="3">
<li>Dentro do diretório templates crie outro diretório chamado polls. Dentro dele, crie um arquivo chamado index.html. Embora o caminho desse arquivo seja polls/templates/polls/index.html, o template loader do Django te permite referenciar esse arquivo simplesmente como polls/index.html.</li>
</ol>

</body>
</html>
